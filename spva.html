
<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>security Secure PVAccess &#8212; PVXS 1.3.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=bb516dca"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="_static/favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="security AuthN &amp; AuthZ" href="spvaauth.html" />
    <link rel="prev" title="developer_guide LDAP Authenticator" href="spvaqstartldap.html" />

   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

<!-- Material Icons -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<!-- Material Symbols Outlined -->
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">

<!-- Inject extra CSS for pages starting with 'spva' -->
<link rel="stylesheet" type="text/css" href="_static/style.css" />


  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="security-secure-pvaccess">
<span id="secure-pvaccess"></span><h1><i class="material-symbols-outlined" style="vertical-align: middle;">security</i> Secure PVAccess<a class="headerlink" href="#security-secure-pvaccess" title="Link to this heading">¶</a></h1>
<p>Secure PVAccess (SPVA) enhances the existing PVAccess protocol by integrating <a class="reference internal" href="#transport-layer-security"><span class="std std-ref">Transport Layer Security</span></a> (TLS)
with comprehensive <a class="reference internal" href="spvacerts.html#certificate-management"><span class="std std-ref"> Cert Management</span></a>, enabling encrypted communication channels and authenticated connections
between EPICS clients and servers (EPICS agents) - see <a class="reference internal" href="spvaauth.html#authn-and-authz"><span class="std std-ref"> AuthN &amp; AuthZ</span></a>.</p>
<p>For a glossary of terms see: <a class="reference internal" href="spvaglossary.html#glossary"><span class="std std-ref"> SPVA Glossary</span></a></p>
<p>Key Features:</p>
<ul class="simple">
<li><p>Encrypted communication using <code class="docutils literal notranslate"><span class="pre">TLS</span> <span class="pre">1.3</span></code></p></li>
<li><p>Certificate-based authentication</p></li>
<li><p>Comprehensive certificate lifecycle management</p></li>
<li><p>Backward compatibility with existing PVAccess deployments</p></li>
<li><p>Integration with site authentication systems</p></li>
</ul>
<p>In SPVA terminology, an <code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">EPICS</span> <span class="pre">Agent</span></code> refers to any PVAccess network client.</p>
<p>Note: This release requires specific unmerged changes to epics-base.</p>
<p>See <a class="reference internal" href="spvaqstart.html#quick-start"><span class="std std-ref"> Secure PVXS</span></a> to get started.</p>
<section id="transport-layer-security">
<span id="id1"></span><h2>Transport Layer Security<a class="headerlink" href="#transport-layer-security" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">SPVA</span></code> uses <code class="docutils literal notranslate"><span class="pre">TLS</span> <span class="pre">1.3</span></code> to establish secure connections between EPICS agents. Both client and server
can authenticate their peer using <code class="docutils literal notranslate"><span class="pre">X.509</span></code> certificates. Key features of the TLS implementation:</p>
<ul class="simple">
<li><p>Mutual authentication when both peers present valid certificates</p></li>
<li><p>Server-only authentication when only the server presents a certificate</p></li>
<li><p>Fallback to <code class="docutils literal notranslate"><span class="pre">TCP</span></code> when <code class="docutils literal notranslate"><span class="pre">TLS</span></code> is not configured or certificates are invalid</p></li>
<li><p>Certificate status verification during connection establishment</p></li>
</ul>
<section id="supported-keychain-file-formats-encodings-and-file-types">
<h3>Supported Keychain-File Formats, Encodings and File Types<a class="headerlink" href="#supported-keychain-file-formats-encodings-and-file-types" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>File Type</p></th>
<th class="head"><p>Extension</p></th>
<th class="head"><p>Encoding</p></th>
<th class="head"><p>Includes Private Key?</p></th>
<th class="head"><p>Includes Certificate Chain?</p></th>
<th class="head"><p>Common Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line">PKCS#12</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">.p12</span></code>, <code class="docutils literal notranslate"><span class="pre">.pfx</span></code></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Binary</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Optional (password)</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Yes</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Distributing cert key</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>To use any of these formats just use the appropriate file extension when specifying the keychain file.</p>
</section>
<section id="unsupported-certificate-formats-encodings-and-file-types">
<h3>Unsupported Certificate Formats, Encodings and File Types<a class="headerlink" href="#unsupported-certificate-formats-encodings-and-file-types" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>File Type</p></th>
<th class="head"><p>Extension</p></th>
<th class="head"><p>Encoding</p></th>
<th class="head"><p>Includes Private Key?</p></th>
<th class="head"><p>Includes Certificate Chain?</p></th>
<th class="head"><p>Common Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line">PEM</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">.pem</span></code>, <code class="docutils literal notranslate"><span class="pre">.crt</span></code>,</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">.cer</span></code>, <code class="docutils literal notranslate"><span class="pre">.key</span></code></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Base64</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Optional</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Optional (concatenated)</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Web servers, OpenSSL</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">JKS</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">.jks</span></code></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Binary</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Optional</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Yes</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Java applications</div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="tls-encapsulation-of-the-pvaccess-protocol">
<h3>TLS encapsulation of the PVAccess protocol<a class="headerlink" href="#tls-encapsulation-of-the-pvaccess-protocol" title="Link to this heading">¶</a></h3>
<p>In network protocols, encapsulation is used to transport a higher layer protocol over a lower layer protocol, e.g., <code class="docutils literal notranslate"><span class="pre">TCP</span></code> over <code class="docutils literal notranslate"><span class="pre">IP</span></code>.
In the context of TLS, PVAccess messages are encapsulated within <code class="docutils literal notranslate"><span class="pre">TLS</span></code> records for secure transport.</p>
<p>Encapsulation involves wrapping the higher-layer protocol’s data within the lower-layer protocol’s format.
TLS is so named because it wraps all data above the <code class="docutils literal notranslate"><span class="pre">Transport</span> <span class="pre">Layer</span></code> in an impermeable <code class="docutils literal notranslate"><span class="pre">Security</span></code> layer.
For SPVA, this means PVAccess messages are wrapped in TLS records that include headers specifying
content type, protocol version, and length, followed by the encrypted PVAccess data as the payload.</p>
<img alt="TLS Encapsulation of PVAccess" class="align-center" src="_images/pvaencapsulation.png" />
<p>Note: We use <code class="docutils literal notranslate"><span class="pre">TLS</span> <span class="pre">version</span> <span class="pre">1.3</span></code> for Secure PVAccess. This version deprecates support for connection renegotiation which is a security risk. So any
connections that are established using Secure PVAccess will not be renegotiated but will be closed if a certificate is revoked or needs to be renewed</p>
</section>
<section id="environment-variables">
<span id="id2"></span><h3>Environment Variables<a class="headerlink" href="#environment-variables" title="Link to this heading">¶</a></h3>
<p>The following environment variables control SPVA behavior:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is an implied hierarchy to the applicability of the environment variables such that
the PVAS version supersedes a PVA version.
So, if an EPICS server agent wants to specify its keychain file location it can simply
provide the <code class="docutils literal notranslate"><span class="pre">EPICS_PVA_TLS_KEYCHAIN</span></code> environment variable as long as
<code class="docutils literal notranslate"><span class="pre">EPICS_PVAS_TLS_KEYCHAIN</span></code> is not configured.</p>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Key</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>EPICS_PVA_TLS_KEYCHAIN</p></td>
<td colspan="2" rowspan="2"><p>{fully qualified path  to keychain file}</p>
<p>e.g. <code class="docutils literal notranslate"><span class="pre">~/.config/client.p12</span></code>,
<code class="docutils literal notranslate"><span class="pre">~/.config/server.p12</span></code></p>
</td>
<td rowspan="2"><p>This is the string that determines the fully qualified path
to the keychain file that contains the certificate,
and private keys used in the TLS handshake.
Note: If not specified then TLS is disabled</p></td>
</tr>
<tr class="row-odd"><td><p>EPICS_PVAS_TLS_KEYCHAIN</p></td>
</tr>
<tr class="row-even"><td><p>EPICS_PVA_TLS_KEYCHAIN
_PWD_FILE</p></td>
<td colspan="2" rowspan="2"><p>{fully qualified path to keychain password file}</p>
<p>e.g. <code class="docutils literal notranslate"><span class="pre">~/.config/client.pass</span></code>,
<code class="docutils literal notranslate"><span class="pre">~/.config/server.pass</span></code></p>
</td>
<td rowspan="2"><p>This is the string that determines the fully qualified path
to a file that contains the password that unlocks the
keychain file.  This is optional.  If not specified, the
keychain file contents will not be encrypted. It is not
recommended to not specify a password file.</p></td>
</tr>
<tr class="row-odd"><td><p>EPICS_PVAS_TLS_KEYCHAIN
_PWD_FILE</p></td>
</tr>
<tr class="row-even"><td rowspan="10"><p>EPICS_PVA_TLS_OPTIONS</p>
<p>Sets the TLS options
for clients and servers.
A string containing
key/value pairs
separated by commas,
tabs or newlines</p>
</td>
<td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">client_cert</span></code></p>
<p>Determines whether client
certificates are required</p>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">optional</span></code> (default)</p></td>
<td><p>Require client certificate to be presented.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">require</span></code></p></td>
<td><p>Don’t require client certificate to be presented.</p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p><code class="docutils literal notranslate"><span class="pre">on_expiration</span></code></p>
<p>Determines what to do when
an EPICS agent’s
certificate has expired,
and a new one can’t be
automatically provisioned</p>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">fallback-to-tcp</span></code>  (default)</p></td>
<td><p>For servers only tcp search requests will be responded to.
For clients then no client certificate will be presented
in the TLS handshake (but searches will still offer both tls
and tcp as supported protocols)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">shutdown</span></code></p></td>
<td><p>The process will exit gracefully.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">standby</span></code></p></td>
<td><p>Servers will not respond to any requests until a new
certificate is successfully provisioned.  It will keep
retrying the keychain file periodically.  When a valid
certificate is available it will continue as normal.</p>
<p>For a client standby has the same effect as shutdown.</p>
</td>
</tr>
<tr class="row-odd"><td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">on_no_cms</span></code></p>
<p>Determines what to do when
CMS is unavailable</p>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">fallback-to-tcp</span></code> (default)</p></td>
<td><p>If revocation status check is required but CMS cannot
degrade connections to TCO mode</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">throw</span></code></p></td>
<td><p>Otherwise throw an exception</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">no_revocation_check</span></code></p>
<p>Determines whether cert
status is monitored</p>
</td>
<td></td>
<td><p>This flag, if present, disables certificate status monitoring
so clients / servers will not know if certificates have been
revoked.
Default: status monitoring is not disabled</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">no_stapling</span></code></p>
<p>Determines whether
stapling is enabled</p>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">yes</span></code>, <code class="docutils literal notranslate"><span class="pre">true</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p>Servers won’t staple certificate status, clients won’t
request stapling information during TLS handshake</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">no</span></code>, <code class="docutils literal notranslate"><span class="pre">false</span></code>, <code class="docutils literal notranslate"><span class="pre">0</span></code> (default)</p></td>
<td><p>Don’t disable stapling</p></td>
</tr>
<tr class="row-even"><td><p>EPICS_PVA_TLS_PORT</p></td>
<td colspan="2" rowspan="2"><p>{port number} default <code class="docutils literal notranslate"><span class="pre">5076</span></code></p>
<p>e.g. <code class="docutils literal notranslate"><span class="pre">8076</span></code></p>
</td>
<td rowspan="2"><p>This is a number that determines the port used for the Secure
PVAccess, either as the port on the Secure PVAccess server
for clients to connect to - PVA, or as the local port number
for Secure PVAccess servers to listen on - PVAS.</p></td>
</tr>
<tr class="row-odd"><td><p>EPICS_PVAS_TLS_PORT</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>EPICS_PVAS_TLS_STOP
_IF_NO_CERT.</p></td>
<td colspan="2"><p><code class="docutils literal notranslate"><span class="pre">yes</span></code>, <code class="docutils literal notranslate"><span class="pre">true</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td rowspan="2"><p>For servers only. Stop if no certificate is provided.</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p><code class="docutils literal notranslate"><span class="pre">no</span></code>, <code class="docutils literal notranslate"><span class="pre">false</span></code>, <code class="docutils literal notranslate"><span class="pre">0</span></code> (default)</p></td>
</tr>
<tr class="row-even"><td><p>SSLKEYLOGFILE</p></td>
<td colspan="2"><p>{fully qualified path to key log file}</p>
<p>e.g. <code class="docutils literal notranslate"><span class="pre">~/.config/keylog</span></code></p>
</td>
<td><p>This is the path to the SSL key log file that, in conjunction
with the build-time macro <code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">PVXS_ENABLE_SSLKEYLOGFILE</span></code>,
controls where and whether we store the session key for TLS
sessions in a file.  If it is defined, then the code will
contain the calls to save the keys in the file specified
by this variable.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="api-configuration-options">
<span id="configuration"></span><h3>API Configuration Options<a class="headerlink" href="#api-configuration-options" title="Link to this heading">¶</a></h3>
<p>The following are new configuration options now available
in both the <a class="reference internal" href="server.html#_CPPv4N4pvxs6server6ConfigE" title="pvxs::server::Config"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::server::Config</span></code></a> and <a class="reference internal" href="client.html#_CPPv4N4pvxs6client6ConfigE" title="pvxs::client::Config"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::client::Config</span></code></a> classes,
via their public base <code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::impl::ConfigCommon</span></code> class:</p>
<ul class="simple">
<li><p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::impl::ConfigCommon::expiration_behaviour</span></code> - Set certificate expiration behavior</p></li>
<li><p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::impl::ConfigCommon::tls_keychain_file</span></code> - Set keychain file path</p></li>
<li><p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::impl::ConfigCommon::tls_keychain_pwd</span></code> - Set keychain file password</p></li>
<li><p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::impl::ConfigCommon::tls_client_cert_required</span></code> - Control client certificate requirements</p></li>
<li><p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::impl::ConfigCommon::tls_disable_stapling</span></code> - Disable certificate status stapling</p></li>
<li><p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::impl::ConfigCommon::tls_disable_status_check</span></code> - Disable certificate status checking</p></li>
<li><p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::impl::ConfigCommon::tls_disabled</span></code> - Disable TLS</p></li>
<li><p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::impl::ConfigCommon::tls_port</span></code> - Set TLS port number</p></li>
<li><p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::impl::ConfigCommon::tls_throw_if_cant_verify</span></code> - Control verification failure behavior</p></li>
</ul>
<p>Here are server-specific configuration options:</p>
<ul class="simple">
<li><p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::server::Config::tls_stop_if_no_cert</span></code> - Stop server if certificate unavailable</p></li>
<li><p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::server::Config::tls_throw_if_no_cert</span></code> - Throw exception if certificate unavailable</p></li>
</ul>
</section>
<section id="api-additions-for-secure-pvaccess">
<h3>API Additions for Secure PVAccess<a class="headerlink" href="#api-additions-for-secure-pvaccess" title="Link to this heading">¶</a></h3>
<section id="runtime-reconfiguration">
<h4>Runtime Reconfiguration<a class="headerlink" href="#runtime-reconfiguration" title="Link to this heading">¶</a></h4>
<p>Allows runtime reconfiguration of a TLS connection.  It does this by dropping all TLS connections and
then re-initialising them using the given configuration.  This means checking if the certificates
and keys exist, loading and verifying them, checking for status and status of peers, etc.</p>
<p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::client::Context::reconfigure</span></code> and <code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::server::Server::reconfigure</span></code> allow runtime TLS configuration updates:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// Initial client setup with certificate</span>
<span class="k">auto</span><span class="w"> </span><span class="n">cli_conf</span><span class="p">(</span><span class="n">serv</span><span class="p">.</span><span class="n">clientConfig</span><span class="p">());</span>
<span class="n">cli_conf</span><span class="p">.</span><span class="n">tls_keychain_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;client1.p12&quot;</span><span class="p">;</span>
<span class="k">auto</span><span class="w"> </span><span class="n">cli</span><span class="p">(</span><span class="n">cli_conf</span><span class="p">.</span><span class="n">build</span><span class="p">());</span>

<span class="c1">// Later reconfiguration with new certificate</span>
<span class="n">cli_conf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cli</span><span class="p">.</span><span class="n">config</span><span class="p">();</span>
<span class="n">cli_conf</span><span class="p">.</span><span class="n">tls_keychain_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;client2.p12&quot;</span><span class="p">;</span>
<span class="n">cli_conf</span><span class="p">.</span><span class="n">tls_keychain_pwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;pwd&quot;</span><span class="p">;</span>
<span class="n">cli</span><span class="p">.</span><span class="n">reconfigure</span><span class="p">(</span><span class="n">cli_conf</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="wildcard-pv-support">
<h4>Wildcard PV Support<a class="headerlink" href="#wildcard-pv-support" title="Link to this heading">¶</a></h4>
<p>This addition is based on the Wildcard PV support included in epics-base since version 3.  It
extends this support to pvxs allowing PVs to be specified as wildcard patterns.  We use this
to provide individualised PVs for each certificate’s status management.</p>
<p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">pvxs::server::SharedWildcardPV</span></code> support for pattern-matched PV names:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define a server that responds to any SEARCH request with WILDCARD:PV:&lt;4-characters&gt;:&lt;any-string&gt;</span>
<span class="c1">// It will extract the 4-character part of the PV name as the `id` and</span>
<span class="c1">// the last string as the `name`</span>

<span class="n">SharedWildcardPV</span><span class="w"> </span><span class="nf">wildcard_pv</span><span class="p">(</span><span class="n">SharedWildcardPV</span><span class="o">::</span><span class="n">buildMailbox</span><span class="p">());</span>
<span class="n">wildcard_pv</span><span class="p">.</span><span class="n">onFirstConnect</span><span class="p">([](</span><span class="n">SharedWildcardPV</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pv</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pv_name</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">parameters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Extract id and name from parameters</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parameters</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">it</span><span class="p">;</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*++</span><span class="n">it</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Process and post value</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pv</span><span class="p">.</span><span class="n">isOpen</span><span class="p">(</span><span class="n">pv_name</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">pv</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">pv_name</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">pv</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="n">pv_name</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">});</span>
<span class="n">wildcard_pv</span><span class="p">.</span><span class="n">onLastDisconnect</span><span class="p">([](</span><span class="n">SharedWildcardPV</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pv</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">pv_name</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">parameters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">pv</span><span class="p">.</span><span class="n">close</span><span class="p">(</span><span class="n">pv_name</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// Add wildcard PV to server</span>
<span class="n">serv</span><span class="p">.</span><span class="n">addPV</span><span class="p">(</span><span class="s">&quot;WILDCARD:PV:????:*&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">wildcard_pv</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="protocol-operation">
<span id="id3"></span><h2>Protocol Operation<a class="headerlink" href="#protocol-operation" title="Link to this heading">¶</a></h2>
<section id="connection-establishment">
<span id="id4"></span><h3>Connection Establishment<a class="headerlink" href="#connection-establishment" title="Link to this heading">¶</a></h3>
<p>Connections are established using TLS if at least the server side is configured for TLS.</p>
<p>Prior to the TLS handshake:</p>
<ul class="simple">
<li><p>Certificates are loaded and validated</p></li>
<li><p>CA trust is verified all the way down the chain</p></li>
<li><p>Both sides subscribe to certificate status where configured for their own certificate and all those in the chain</p></li>
<li><p>All certificate statues are cached</p></li>
</ul>
<p>During the TLS handshake:</p>
<ul class="simple">
<li><p>Certificates are exchanged</p></li>
<li><p>Servers staple cached certificate status in handshake</p></li>
<li><p>Both sides validate and verify their peer certificate against trusted root certificates</p></li>
</ul>
<p>After the TLS handshake:</p>
<ul class="simple">
<li><p>Both sides subscribe to peer certificate status where configured</p></li>
<li><p>Clients may use OCSP stapled status immediately before waiting for status monitoring results</p></li>
</ul>
</section>
<section id="state-machines">
<span id="id5"></span><h3>State Machines<a class="headerlink" href="#state-machines" title="Link to this heading">¶</a></h3>
<p><em>Server TLS Context State Machine:</em></p>
<p>The server transitions based on:</p>
<ul class="simple">
<li><p>Certificate validity</p></li>
<li><p>CA trust status</p></li>
<li><p>Certificate status monitoring results</p></li>
<li><p><a class="reference internal" href="#configuration"><span class="std std-ref">API Configuration Options</span></a> options (e.g., stop_if_no_cert)</p></li>
</ul>
<p>States:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Init</span></code>: Initial state, loads and validates certificates</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TcpReady</span></code>: Responds to TCP protocol requests when certificates are valid</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TlsReady</span></code>: Responds to both TCP and TLS protocol requests</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DegradedMode</span></code>: Fallback state for invalid certificates or missing TLS configuration</p></li>
</ul>
<img alt="SPVA Server TLS Context State Machine" class="align-center" src="_images/spva_tls_context_state_machine.png" />
<p><em>Client TLS Context State Machine:</em></p>
<p>Similar to server state machine but</p>
<ul class="simple">
<li><p>Never exits on TLS configuration issues</p></li>
<li><p>Moves to <code class="docutils literal notranslate"><span class="pre">DEGRADED</span></code> state and continues with TCP protocol if needed</p></li>
</ul>
<img alt="SPVA Client TLS Context State Machine" class="align-center" src="_images/spva_tls_client_context_state_machine.png" />
<section id="search-handler-state-machines">
<span id="tls-context-search-state-machine"></span><h4>Search Handler State Machines<a class="headerlink" href="#search-handler-state-machines" title="Link to this heading">¶</a></h4>
<p><em>Server Search Handler:</em></p>
<p>States:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DegradedMode</span></code>: Responds only to TCP protocol requests</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TcpReady</span></code>: Responds only to TCP protocol requests, ignores TLS</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TlsReady</span></code>: Responds to both TCP and TLS protocol requests</p></li>
</ul>
<img alt="SPVA Server TLS Context Search Handler State Machine" class="align-center" src="_images/spva_tls_context_search_states.png" />
<p><em>Client Search Handler:</em></p>
<ul class="simple">
<li><p>Similar to server but from client perspective</p></li>
<li><p>Executes <code class="docutils literal notranslate"><span class="pre">TLS_CONNECTOR</span></code> on successful TLS handshake</p></li>
<li><p>Falls back to <code class="docutils literal notranslate"><span class="pre">TCP_CONNECTOR</span></code> otherwise</p></li>
</ul>
<img alt="SPVA Client TLS Context Search Handler State Machine" class="align-center" src="_images/spva_tls_client_context_search_states.png" />
</section>
<section id="connection-state-machines">
<span id="connection-state-machine"></span><h4>Connection State Machines<a class="headerlink" href="#connection-state-machines" title="Link to this heading">¶</a></h4>
<p><em>Server Connection:</em></p>
<ul class="simple">
<li><p>Manages TLS handshake and certificate validation</p></li>
<li><p>Monitors peer certificate status</p></li>
<li><p>Continues normal operation only after successful validation</p></li>
</ul>
<img alt="SPVA Connection State Machines" class="align-center" src="_images/spva_connection_state_machines.png" />
<p><em>Client Connection:</em></p>
<ul class="simple">
<li><p>Similar to server but verifies stapled certificates</p></li>
<li><p>Destroys connection on completion</p></li>
</ul>
<img alt="SPVA Client Connection State Machine" class="align-center" src="_images/spva_client_connection_state_machines.png" />
</section>
<section id="tls-handshake">
<span id="id6"></span><h4>TLS Handshake<a class="headerlink" href="#tls-handshake" title="Link to this heading">¶</a></h4>
<p>The following diagram shows the simplified TLS handshake sequence between server and client:</p>
<img alt="SPVA Sequence Diagram" class="align-center" src="_images/spvaseqdiag.png" />
<ol class="arabic simple">
<li><p>Each agent uses an <code class="docutils literal notranslate"><span class="pre">X.509</span></code> certificate for peer authentication</p></li>
<li><p>During handshake:</p>
<ul class="simple">
<li><p>Certificates are exchanged</p></li>
<li><p>Both sides verify peer certificates against trusted root certificates</p></li>
<li><p>Multiple certificates may be verified in the chain to trusted CA</p></li>
<li><p>Local verification checks signature, expiration, and usage flags</p></li>
</ul>
</li>
<li><p>SPVA certificates may include status monitoring extension requiring:</p>
<ul class="simple">
<li><p>Subscription to certificate status from issuing Certificate Authority’s service (<a class="reference internal" href="spvacerts.html#pvacms"><span class="std std-ref">PVACMS</span></a>)</p></li>
<li><p>Receipt of GOOD status before trust</p></li>
</ul>
</li>
<li><p>Agents subscribe to:</p>
<ul class="simple">
<li><p>Peer’s certificate status</p></li>
<li><p>Own certificate status and certificate chain</p></li>
</ul>
</li>
<li><p>Servers cache and staple certificate status in handshake</p></li>
</ol>
</section>
</section>
<section id="ocsp-and-status-verification">
<span id="online-certificate-status-protocol-ocsp"></span><h3>OCSP and Status Verification<a class="headerlink" href="#ocsp-and-status-verification" title="Link to this heading">¶</a></h3>
</section>
<section id="ocsp-stapling">
<span id="id7"></span><h3>OCSP Stapling<a class="headerlink" href="#ocsp-stapling" title="Link to this heading">¶</a></h3>
<p>OCSP Stapling optimizes certificate status verification during TLS handshake:</p>
<figure class="align-center" id="id8">
<a class="reference internal image-reference" href="images/ocsp_stapling.png"><img alt="images/ocsp_stapling.png" src="images/ocsp_stapling.png" style="width: 800px;" />
</a>
</figure>
<ul class="simple">
<li><p>Enabled by default with status monitoring extension</p></li>
<li><p>Disable using EPICS_PVAS_TLS_OPTIONS=”disable_stapling”</p></li>
</ul>
</section>
<section id="status-verification">
<span id="id9"></span><h3>Status Verification<a class="headerlink" href="#status-verification" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p>Certificate Status recieved from the PVACMS for a certificate returns a <code class="docutils literal notranslate"><span class="pre">GOOD</span></code> status
if, and only if, the certificate status is good and so is that of its certificate authority certificate
chain all the way back to the root certificate.  In this way agents need monitor
only their own entity certificate and that of their peer.</p>
</div></blockquote>
<p>Certificate status verification occurs at several points:</p>
<ol class="arabic simple">
<li><p>Initial Connection</p>
<ul class="simple">
<li><p>Certificates are verified during TLS handshake</p></li>
<li><p>Both peers verify against a trusted root certificates that they have loaded from their own keychain file</p></li>
<li><p>Basic checks include:</p>
<ul>
<li><p>Signature validation</p></li>
<li><p>Expiration dates</p></li>
<li><p>Usage flags</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Runtime Monitoring</p>
<ul class="simple">
<li><p>EPICS agents subscribe to:</p>
<ul>
<li><p>Their own certificate status</p></li>
<li><p>Peer entity certificate status</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Status Response Handling</p>
<ul class="simple">
<li><p>If status not received:</p>
<ul>
<li><p>Search requests are ignored</p></li>
<li><p>Client retries later</p></li>
</ul>
</li>
<li><p>If status not GOOD:</p>
<ul>
<li><p>Server offers only TCP protocol</p></li>
<li><p>Client fails connection validation</p></li>
</ul>
</li>
<li><p>If status GOOD:</p>
<ul>
<li><p>Server offers both TCP and TLS</p></li>
<li><p>Connection proceeds normally</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Optimization</p>
<ul class="simple">
<li><p>Servers cache status for stapling</p></li>
<li><p>Clients can use stapled status</p></li>
<li><p>Reduces initial <a class="reference internal" href="spvacerts.html#pvacms"><span class="std std-ref">PVACMS</span></a> requests</p></li>
</ul>
</li>
</ol>
</section>
<section id="status-caching">
<span id="id10"></span><h3>Status Caching<a class="headerlink" href="#status-caching" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Agents subscribe to peer certificate</p></li>
<li><p>Status transitions trigger connection status re-evaluation</p></li>
<li><p>Cached status used within validity period to reduce <a class="reference internal" href="spvacerts.html#pvacms"><span class="std std-ref">PVACMS</span></a> requests</p></li>
<li><p>Servers staple cached status in handshake</p></li>
<li><p>Clients may skip initial <a class="reference internal" href="spvacerts.html#pvacms"><span class="std std-ref">PVACMS</span></a> request using stapled status</p></li>
</ul>
</section>
<section id="beacons">
<h3>Beacons<a class="headerlink" href="#beacons" title="Link to this heading">¶</a></h3>
<p>PVAccess Beacon Messages have not been upgraded to TLS support. Important considerations:</p>
<ol class="arabic simple">
<li><p>Historical Use:
- Previously used to trigger resend of unanswered Search Messages
- This practice is now discouraged
- Other methods should be used to determine server status</p></li>
<li><p>Current Behavior:
- Servers broadcast on any configured port
- Clients should not use ports directly
- Use only as server availability indicator</p></li>
<li><p>Security Implications:
- Beacons remain unencrypted
- Do not contain sensitive information
- Cannot be used for secure discovery</p></li>
</ol>
</section>
</section>
<section id="protocol-debugging">
<span id="id11"></span><h2>Protocol Debugging<a class="headerlink" href="#protocol-debugging" title="Link to this heading">¶</a></h2>
<section id="tls-packet-inspection">
<h3>TLS Packet Inspection<a class="headerlink" href="#tls-packet-inspection" title="Link to this heading">¶</a></h3>
<p>For detailed TLS traffic analysis:</p>
<ol class="arabic simple">
<li><p>Enable key logging at build time:</p>
<ul class="simple">
<li><p>Set PVXS_ENABLE_SSLKEYLOGFILE during compilation</p></li>
</ul>
</li>
<li><p>Configure runtime logging:</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">SSLKEYLOGFILE</span><span class="o">=</span>/tmp/sslkeylog.log
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Configure Wireshark:</p>
<ul class="simple">
<li><p>Edit &gt; Preferences &gt; Protocols &gt; TLS</p></li>
<li><p>Set “(Pre)-Master-Secret log filename” to match SSLKEYLOGFILE path</p></li>
<li><p>TLS traffic will now be decrypted in Wireshark</p></li>
</ul>
</li>
</ol>
</section>
<section id="debug-logging">
<h3>Debug Logging<a class="headerlink" href="#debug-logging" title="Link to this heading">¶</a></h3>
<p>Enable detailed PVXS debug logging:</p>
<ol class="arabic simple">
<li><p>Environment variable method:</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">PVXS_LOG</span><span class="o">=</span><span class="s2">&quot;pvxs.stapling*=DEBUG&quot;</span>
</pre></div>
</div>
<p>New Debug Categories:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pvxs.certs.auth</span></code>          - Authenticators</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvxs.auth.cfg</span></code>            - Authn configuration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvxs.auth.cms</span></code>            - CMS</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvxs.auth.jwt</span></code>            - JWT Authenticator</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvxs.auth.krb</span></code>            - Kerberos Authenticator</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvxs.auth.mon</span></code>            - Certificate Status Monitoring</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvxs.auth.stat</span></code>           - Certificate Status</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvxs.auth.std</span></code>            - Standard Authenticator</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvxs.auth.tool</span></code>           - Certificate Management Tools (<code class="docutils literal notranslate"><span class="pre">pvacert</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvxs.certs.status</span></code>        - Certificate Status Management</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvxs.ossl.init</span></code>           - TLS initialization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvxs.ossl.io</span></code>             - TLS I/O</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvxs.stapling</span></code>            - OCSP stapling</p></li>
</ul>
</section>
</section>
<section id="network-deployment">
<span id="id12"></span><h2>Network Deployment<a class="headerlink" href="#network-deployment" title="Link to this heading">¶</a></h2>
<section id="deployment-patterns">
<h3>Deployment Patterns<a class="headerlink" href="#deployment-patterns" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>Standard Network Deployment</p>
<ul class="simple">
<li><p>Agents run on networked hosts with local storage</p></li>
<li><p>Certificates stored in local protected directories</p></li>
<li><p>Standard TLS configuration applies</p></li>
</ul>
</li>
<li><p>Diskless Network Deployment</p>
<ul class="simple">
<li><p>Agents run on hosts without local storage</p></li>
<li><p>Certificates stored on network-mounted storage</p></li>
<li><p>Special considerations for certificate protection</p></li>
</ul>
</li>
<li><p>Hybrid Deployment</p>
<ul class="simple">
<li><p>Mix of standard and diskless nodes</p></li>
<li><p>Common trust anchor required</p></li>
<li><p>Consistent <a class="reference internal" href="spvacerts.html#certificate-management"><span class="std std-ref"> Cert Management</span></a> across node types</p></li>
</ul>
</li>
</ol>
</section>
<section id="certificate-storage">
<h3>Certificate Storage<a class="headerlink" href="#certificate-storage" title="Link to this heading">¶</a></h3>
<p>Standard Nodes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">XDG_CONFIG_HOME</span></code> standard is used by default to locate certificates for clients and server</p>
<ul>
<li><p>default if not set is <code class="docutils literal notranslate"><span class="pre">~/.config</span></code></p></li>
<li><p>we append <code class="docutils literal notranslate"><span class="pre">/pva/1.3/</span></code> to make the full path default to <code class="docutils literal notranslate"><span class="pre">~/.config/pva/1.3/</span></code></p></li>
<li><p>client certificates are stored in <code class="docutils literal notranslate"><span class="pre">client.p12</span></code> by default</p></li>
<li><p>server certificates are stored in <code class="docutils literal notranslate"><span class="pre">server.p12</span></code> by default</p></li>
</ul>
</li>
<li><p>Store certificates in local protected directory</p>
<ul>
<li><p>the files are protected with <code class="docutils literal notranslate"><span class="pre">400</span></code> so that only the owner can read</p></li>
</ul>
</li>
<li><p>Automatic reconfiguration on certificate updates</p></li>
</ul>
<p>Diskless Nodes:</p>
<ul class="simple">
<li><p>Use network-mounted storage (NFS, SMB/CIFS, AFP)</p></li>
<li><p>Protected certificate storage location</p></li>
<li><p>Optional password protection via diskless server</p></li>
</ul>
</section>
<section id="trust-establishment">
<h3>Trust Establishment<a class="headerlink" href="#trust-establishment" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>Root Certificate Distribution:</p>
<ul class="simple">
<li><p>Administrators must distribute PKCS#12 files containing the CA Root certificate to all clients</p></li>
<li><p>These files must be stored at the location pointed to by EPICS_PVA_TLS_KEYCHAIN or equivalent</p></li>
<li><p>These files are replaced with any new certificates that are generated for the user but
the root certificate authority certificate is preserved</p></li>
<li><p>Use of publicly signed root certificates is not supported at present</p></li>
<li><p>The only exception is when clients use any Authenticator to generate certificates.
In this case the root certificate authority certificate is delivered with the certificate.  Users
must verify that the issuer of the certificate matches the Root CA they are expecting.</p></li>
<li><p>Consistent across all deployment types</p></li>
</ul>
</li>
<li><p>Certificate Authority:</p>
<ul class="simple">
<li><p><a class="reference internal" href="spvacerts.html#pvacms"><span class="std std-ref">PVACMS</span></a> serves as site CA</p></li>
<li><p>Common trust anchor for all nodes</p></li>
<li><p>Handles certificate lifecycle management</p></li>
</ul>
</li>
</ol>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PVXS</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="netconfig.html">PVA Network Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="spvaqstart.html"><i class="material-symbols-outlined" style="vertical-align: middle;">developer_guide</i> Secure PVXS</a></li>
<li class="toctree-l1"><a class="reference internal" href="spvaqstartstd.html"><i class="material-symbols-outlined" style="vertical-align: middle;">developer_guide</i> Std. Authenticator</a></li>
<li class="toctree-l1"><a class="reference internal" href="spvaqstartkrb.html"><i class="material-symbols-outlined" style="vertical-align: middle;">developer_guide</i> KRB Authenticator</a></li>
<li class="toctree-l1"><a class="reference internal" href="spvaqstartldap.html"><i class="material-symbols-outlined" style="vertical-align: middle;">developer_guide</i> LDAP Authenticator</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><i class="material-symbols-outlined" style="vertical-align: middle;">security</i> Secure PVAccess</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#transport-layer-security">Transport Layer Security</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#supported-keychain-file-formats-encodings-and-file-types">Supported Keychain-File Formats, Encodings and File Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unsupported-certificate-formats-encodings-and-file-types">Unsupported Certificate Formats, Encodings and File Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tls-encapsulation-of-the-pvaccess-protocol">TLS encapsulation of the PVAccess protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="#environment-variables">Environment Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api-configuration-options">API Configuration Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api-additions-for-secure-pvaccess">API Additions for Secure PVAccess</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#protocol-operation">Protocol Operation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#connection-establishment">Connection Establishment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#state-machines">State Machines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ocsp-and-status-verification">OCSP and Status Verification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ocsp-stapling">OCSP Stapling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#status-verification">Status Verification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#status-caching">Status Caching</a></li>
<li class="toctree-l3"><a class="reference internal" href="#beacons">Beacons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#protocol-debugging">Protocol Debugging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tls-packet-inspection">TLS Packet Inspection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#debug-logging">Debug Logging</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#network-deployment">Network Deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#deployment-patterns">Deployment Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#certificate-storage">Certificate Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#trust-establishment">Trust Establishment</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spvaauth.html"><i class="material-symbols-outlined" style="vertical-align: middle;">security</i> AuthN &amp; AuthZ</a></li>
<li class="toctree-l1"><a class="reference internal" href="spvacerts.html"><i class="material-symbols-outlined" style="vertical-align: middle;">security</i> Cert Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html#including-pvxs-in-your-application">Including PVXS in your application</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="value.html">Value Container API</a></li>
<li class="toctree-l1"><a class="reference internal" href="client.html">Client API</a></li>
<li class="toctree-l1"><a class="reference internal" href="server.html">Server API</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioc.html">IOC Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioc.html#qsrv-2">QSRV 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="util.html">Misc</a></li>
<li class="toctree-l1"><a class="reference internal" href="details.html">Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="spvaglossary.html"><i class="material-symbols-outlined" style="vertical-align: middle;">security</i> SPVA Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="releasenotes.html">Release Notes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="spvaqstartldap.html" title="previous chapter"><i class="material-symbols-outlined" style="vertical-align: middle;">developer_guide</i> LDAP Authenticator</a></li>
      <li>Next: <a href="spvaauth.html" title="next chapter"><i class="material-symbols-outlined" style="vertical-align: middle;">security</i> AuthN &amp; AuthZ</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025 Michael Davidsaver, George McIntyre, Osprey DCS LLC, and SLAC.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/spva.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>